{% extends 'church/base.html' %}
{% load thumbnail %}

{% block title %}News Line - Breaking Barriers International{% endblock %}

{% block content %}
<div x-data="{ 
    modalOpen: false, 
    modalImage: '', 
    modalTitle: '', 
    modalSummary: '',
    openModal(image, title, summary) {
        this.modalImage = image;
        this.modalTitle = title;
        this.modalSummary = summary;
        this.modalOpen = true;
        document.body.style.overflow = 'hidden'; // Prevent scrolling
    },
    closeModal() {
        this.modalOpen = false;
        document.body.style.overflow = ''; // Restore scrolling
    }
}" @keydown.escape.window="closeModal()">

    <div class="bg-gray-50/50 py-8 sm:py-12 md:py-16 overflow-x-hidden">
        <div class="container mx-auto px-4 sm:px-6 max-w-7xl">
            <div class="max-w-4xl mx-auto text-center mb-10 sm:mb-16">
                <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-4 sm:mb-6 brand-text kaushan-script-regular">
                    News
                    Line</h1>
                <p class="text-base sm:text-lg md:text-xl text-gray-600 leading-relaxed font-light px-2">
                    Stay updated with the latest news, events, and happenings at Breaking Barriers International.
                </p>
                <div class="w-24 h-1 brand-color mx-auto mt-8 rounded-full opacity-30"></div>
            </div>

            {% if articles %}
            <div class="mb-20">
                <div class="flex items-center justify-between mb-10 border-b border-gray-100 pb-6">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-800">Latest News</h2>
                    <span
                        class="text-sm text-gray-500 font-medium bg-white px-4 py-1.5 rounded-full shadow-sm border border-gray-100">
                        {{ total_count }} Articles
                    </span>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8" id="articles-container">
                    {% include 'church/partials/news_line_items.html' %}
                </div>
            </div>
            {% else %}
            <div class="text-center py-20 bg-white rounded-3xl border border-gray-100 shadow-sm">
                <div class="mb-4">
                    <i class="fas fa-newspaper text-5xl text-gray-200"></i>
                </div>
                <p class="text-gray-500 font-light italic">News articles will be available soon.</p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Lightbox Modal -->
    <div x-show="modalOpen" style="display: none;" x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
        x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0" class="fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6"
        role="dialog" aria-modal="true">

        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/90 backdrop-blur-sm" @click="closeModal()"></div>

        <!-- Modal Content -->
        <div class="relative w-full max-w-6xl max-h-[90vh] flex flex-col items-center justify-center pointer-events-none"
            x-transition:enter="transition ease-out duration-300 transform"
            x-transition:enter-start="opacity-0 scale-95 translate-y-4"
            x-transition:enter-end="opacity-100 scale-100 translate-y-0"
            x-transition:leave="transition ease-in duration-200 transform"
            x-transition:leave-start="opacity-100 scale-100 translate-y-0"
            x-transition:leave-end="opacity-0 scale-95 translate-y-4">

            <!-- Close Button -->
            <button @click="closeModal()"
                class="pointer-events-auto absolute -top-12 right-0 text-white/70 hover:text-white transition-colors p-2 z-50">
                <i class="fas fa-times text-2xl"></i>
            </button>

            <!-- Container -->
            <div
                class="bg-black rounded-lg shadow-2xl overflow-hidden pointer-events-auto flex flex-col lg:flex-row max-h-full w-full">

                <!-- Image Section -->
                <div class="relative flex-grow min-h-0 lg:min-w-0 bg-black flex items-center justify-center lg:w-2/3">
                    <img :src="modalImage" :alt="modalTitle"
                        class="max-w-full max-h-[50vh] lg:max-h-[90vh] object-contain mx-auto">
                </div>

                <!-- Caption/Summary Section -->
                <div
                    class="bg-white/95 backdrop-blur-md p-6 sm:p-8 overflow-y-auto lg:w-1/3 border-l border-gray-800 max-h-[40vh] lg:max-h-full flex flex-col">
                    <h3 x-text="modalTitle"
                        class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 kaushan-script-regular flex-shrink-0">
                    </h3>
                    <div class="overflow-y-auto pr-2 custom-scrollbar">
                        <div x-html="modalSummary"
                            class="text-gray-700 leading-relaxed font-light text-sm sm:text-base prose prose-sm max-w-none">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
{% endblock %}