{% load thumbnail %}
{% for image in gallery_images %}
<div class="relative overflow-hidden rounded-lg shadow-md hover:shadow-xl transition duration-300 cursor-pointer"
    @click="openModal()"
    x-data="{ 
        openModal() { 
            {% if image.video_url %}
            $dispatch('open-lightbox', { 
                url: '{{ image.get_embed_url }}', 
                caption: '{{ image.caption|escapejs }}',
                isVideo: true 
            })
            {% else %}
            $dispatch('open-lightbox', { 
                url: '{{ image.image.url }}', 
                caption: '{{ image.caption|escapejs }}',
                isVideo: false 
            })
            {% endif %}
        } 
    }">
    {% thumbnail image.image "800x600" box=image.image_cropping crop detail as cropped %}
    <img src="{{ cropped.url }}" alt="{{ image.caption }}"
        class="w-full h-64 object-cover hover:scale-110 transition duration-300">
    <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-2">
        <p class="text-sm truncate">{{ image.caption }}</p>
    </div>
</div>
{% empty %}
<div class="col-span-4 text-center text-gray-500 py-12">
    <i class="fas fa-images text-5xl mb-4 text-gray-300"></i>
    <p class="text-xl">No images available in this category.</p>
</div>
{% endfor %}